"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6105],{6641:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"middleware/key-auth","title":"Key Auth","description":"Key auth middleware","source":"@site/docs/middleware/key-auth.md","sourceDirName":"middleware","slug":"/middleware/key-auth","permalink":"/docs/middleware/key-auth","draft":false,"unlisted":false,"editUrl":"https://github.com/labstack/echox/blob/master/website/docs/middleware/key-auth.md","tags":[],"version":"current","frontMatter":{"description":"Key auth middleware"},"sidebar":"docsSidebar","previous":{"title":"JWT","permalink":"/docs/middleware/jwt"},"next":{"title":"Logger","permalink":"/docs/middleware/logger"}}');var i=n(4848),a=n(8453);const o={description:"Key auth middleware"},s="Key Auth",u={},l=[{value:"Usage",id:"usage",level:2},{value:"Custom Configuration",id:"custom-configuration",level:2},{value:"Usage",id:"usage-1",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Default Configuration",id:"default-configuration",level:3}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"key-auth",children:"Key Auth"})}),"\n",(0,i.jsx)(t.p,{children:"Key auth middleware provides a key based authentication."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"For valid key it calls the next handler."}),"\n",(0,i.jsx)(t.li,{children:'For invalid key, it sends "401 - Unauthorized" response.'}),"\n",(0,i.jsx)(t.li,{children:'For missing key, it sends "400 - Bad Request" response.'}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-go",children:'e.Use(middleware.KeyAuth(func(c *echo.Context, key string, source middleware.ExtractorSource) (bool, error) {\n  return key == "valid-key", nil\n}))\n'})}),"\n",(0,i.jsx)(t.h2,{id:"custom-configuration",children:"Custom Configuration"}),"\n",(0,i.jsx)(t.h3,{id:"usage-1",children:"Usage"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-go",children:'e := echo.New()\ne.Use(middleware.KeyAuthWithConfig(middleware.KeyAuthConfig{\n  KeyLookup: "query:api-key",\n  Validator: func(c *echo.Context, key string, source middleware.ExtractorSource) (bool, error) {\n\t\t\treturn key == "valid-key", nil\n\t\t},\n}))\n'})}),"\n",(0,i.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-go",children:'type KeyAuthConfig struct {\n\t// Skipper defines a function to skip middleware.\n\tSkipper Skipper\n\n\t// KeyLookup is a string in the form of "<source>:<name>" or "<source>:<name>,<source>:<name>" that is used\n\t// to extract key from the request.\n\t// Optional. Default value "header:Authorization".\n\t// Possible values:\n\t// - "header:<name>" or "header:<name>:<cut-prefix>"\n\t// \t\t\t`<cut-prefix>` is argument value to cut/trim prefix of the extracted value. This is useful if header\n\t//\t\t\tvalue has static prefix like `Authorization: <auth-scheme> <authorisation-parameters>` where part that we\n\t//\t\t\twant to cut is `<auth-scheme> ` note the space at the end.\n\t//\t\t\tIn case of basic authentication `Authorization: Basic <credentials>` prefix we want to remove is `Basic `.\n\t// - "query:<name>"\n\t// - "form:<name>"\n\t// - "cookie:<name>"\n\t// Multiple sources example:\n\t// - "header:Authorization,header:X-Api-Key"\n\tKeyLookup string\n\n\t// AllowedCheckLimit set how many KeyLookup values are allowed to be checked. This is\n\t// useful environments like corporate test environments with application proxies restricting\n\t// access to environment with their own auth scheme.\n\tAllowedCheckLimit uint\n\n\t// Validator is a function to validate key.\n\t// Required.\n\tValidator KeyAuthValidator\n\n\t// ErrorHandler defines a function which is executed when all lookups have been done and none of them passed Validator\n\t// function. ErrorHandler is executed with last missing (ErrExtractionValueMissing) or an invalid key.\n\t// It may be used to define a custom error.\n\t//\n\t// Note: when error handler swallows the error (returns nil) middleware continues handler chain execution towards handler.\n\t// This is useful in cases when portion of your site/api is publicly accessible and has extra features for authorized users\n\t// In that case you can use ErrorHandler to set default public auth value to request and continue with handler chain.\n\tErrorHandler KeyAuthErrorHandler\n\n\t// ContinueOnIgnoredError allows the next middleware/handler to be called when ErrorHandler decides to\n\t// ignore the error (by returning `nil`).\n\t// This is useful when parts of your site/api allow public access and some authorized routes provide extra functionality.\n\t// In that case you can use ErrorHandler to set a default public key auth value in the request context\n\t// and continue. Some logic down the remaining execution chain needs to check that (public) key auth value then.\n\tContinueOnIgnoredError bool\n}\n'})}),"\n",(0,i.jsx)(t.h3,{id:"default-configuration",children:"Default Configuration"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-go",children:'DefaultKeyAuthConfig = KeyAuthConfig{\n  Skipper:    DefaultSkipper,\n  KeyLookup:  "header:" + echo.HeaderAuthorization,\n  AuthScheme: "Bearer",\n}\n'})})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>s});var r=n(6540);const i={},a=r.createContext(i);function o(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);